<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../assets/styles/pages/login.css" />
    <title>Login</title>
  </head>
  <body>
    <main class="container">
      <form>
        <h1>Login</h1>
        <div class="input-box">
          <input placeholder="Usuário" type="email" />
          <i class="bx bxs-user"></i>
        </div>
        <div class="input-box">
          <input placeholder="Senha" type="password" />
          <i class="bx bxs-lock-alt"></i>
        </div>

        <div class="remember-forgot">
          <label>
            <input type="checkbox" />
            Lembrar senha
          </label>
          <a href="#">Esqueci senha</a>
        </div>

        <button type="submit" class="login">Login</button>

        <div class="register-link">
          <p>
            Não tem uma conta?
            <a href="cadastro.html" id="cadastro-link">Cadastre-se</a>
          </p>
        </div>
      </form>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.7/dist/axios.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        document.querySelector("form").addEventListener("submit", async (e) => {
          e.preventDefault();

          const email = document.querySelector('input[type="email"]').value;
          const password = document.querySelector(
            'input[type="password"]'
          ).value;

          try {
            const response = await axios.post(
              "http://localhost:8000/api/login",
              {
                email,
                password,
              },
              { withCredentials: true }
            );

            if (response.status === 200) {
              window.location.href = "/perfil";
            } else {
              alert("Usuário ou senha inválidos.");
            }
          } catch (error) {
            alert("Erro ao conectar com o servidor.");
          }
        });
      });
    </script>
  </body>
</html>
